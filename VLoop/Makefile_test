# VLoop Unit Test Makefile
# Build and run systematic tests of VLoop logic

CXX = g++
CXXFLAGS = -std=c++11 -Wall -g -O0
TESTDIR = test
BUILDDIR = build

# Test targets
test: $(BUILDDIR)/vloop_unit_tests
	@echo "Running VLoop Unit Tests..."
	@$(BUILDDIR)/vloop_unit_tests

$(BUILDDIR)/vloop_unit_tests: $(TESTDIR)/vloop_unit_tests.cpp | $(BUILDDIR)
	@echo "Building unit tests..."
	@$(CXX) $(CXXFLAGS) $< -o $@

$(BUILDDIR):
	@mkdir -p $(BUILDDIR)

clean-test:
	@echo "Cleaning test builds..."
	@rm -f $(BUILDDIR)/vloop_unit_tests

# Stress test with different parameters
stress-test: $(BUILDDIR)/vloop_unit_tests
	@echo "Running stress tests..."
	@for i in {1..10}; do \
		echo "Stress test iteration $$i:"; \
		$(BUILDDIR)/vloop_unit_tests; \
		echo ""; \
	done

.PHONY: test stress-test clean-test